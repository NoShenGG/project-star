[gd_scene format=3 uid="uid://dikwtund4a5xs"]

[ext_resource type="Script" uid="uid://cetk67agmcktg" path="res://scenes/dev/ZXue/DynaMite/DynaMiteEnemy.gd" id="1_gnlae"]
[ext_resource type="PackedScene" uid="uid://dp3bydn1u3c3c" path="res://art_assets/enemies/dyna_mite/dynamite_anims.glb" id="2_nm8sw"]
[ext_resource type="Script" uid="uid://dcfoaiv83pvo4" path="res://scripts/utility/states/state_machine.gd" id="2_ybb5r"]
[ext_resource type="Script" uid="uid://dr7vgnbn0sbub" path="res://scenes/dev/ZXue/DynaMite/idle.gd" id="3_5e5g7"]
[ext_resource type="Script" uid="uid://bjlnudp8j65ma" path="res://scripts/entities/animation_state.gd" id="3_ud8xd"]
[ext_resource type="Material" uid="uid://mx2enmspa0mc" path="res://art_assets/enemies/dyna_mite/Dynamite_Texture.material" id="3_xrnix"]
[ext_resource type="Script" uid="uid://86kddc0ka3gc" path="res://scenes/dev/ZXue/DynaMite/approach.gd" id="4_ljwvm"]
[ext_resource type="Script" uid="uid://cn026nsv8xexc" path="res://scripts/entities/animated_grass_size_change.gd" id="4_lvi8h"]
[ext_resource type="Script" uid="uid://phpe8yffty68" path="res://scenes/dev/ZXue/DynaMite/countdown.gd" id="5_htoe2"]
[ext_resource type="Script" uid="uid://3uvdfqh6srtl" path="res://scenes/dev/ZXue/DynaMite/dead.gd" id="6_g2vom"]
[ext_resource type="Script" uid="uid://c1iptw5vqre6f" path="res://scripts/entities/enemies/attacks/hitbox.gd" id="7_g2vom"]
[ext_resource type="Script" uid="uid://la2fd47cp2em" path="res://scenes/dev/ZXue/DynaMite/break.gd" id="7_ybb5r"]
[ext_resource type="PackedScene" uid="uid://pv4ghgiiejhk" path="res://scenes/dev/christian_d/enemy_status_bar.tscn" id="10_bnow6"]
[ext_resource type="PackedScene" uid="uid://cent63gp0an85" path="res://vfx/DynaMiteExplodeVFX.tscn" id="11_0gklw"]
[ext_resource type="Script" uid="uid://c2h87hwcx212b" path="res://scripts/entities/player/haptic/HapticCaller.gd" id="14_dlomd"]
[ext_resource type="Script" uid="uid://bk677e0jvjhsw" path="res://scripts/entities/HurtVFX.gd" id="15_7uknu"]
[ext_resource type="PackedScene" uid="uid://c3hpdu6n1fa6d" path="res://scenes/dev/anth/dissolveFX.tscn" id="15_o6d2w"]
[ext_resource type="Script" uid="uid://hrugoc51xhma" path="res://vfx/AutoStartVFX.gd" id="16_dlomd"]
[ext_resource type="Texture2D" uid="uid://qj1lsmefhhje" path="res://vfx/Kenny Particle Pack/circle_05.png" id="17_nm8sw"]
[ext_resource type="Script" uid="uid://b7pj5dra8sjgx" path="res://scripts/entities/DeathVFX.gd" id="18_ud8xd"]
[ext_resource type="Script" uid="uid://dxy6p70rncayl" path="res://scripts/entities/SpawnVFX.gd" id="19_lvi8h"]
[ext_resource type="PackedScene" uid="uid://dtrpcl1nasika" path="res://vfx/enemySummonFX.tscn" id="20_qq5db"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_qq5db"]
animation = &"attack"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_nmqdh"]
animation = &"hurt"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_gnmc2"]
animation = &"idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_jhdi8"]
animation = &"run"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_d8ups"]
states/attack/node = SubResource("AnimationNodeAnimation_qq5db")
states/attack/position = Vector2(687, 100)
states/hurt/node = SubResource("AnimationNodeAnimation_nmqdh")
states/hurt/position = Vector2(569, 100)
states/idle/node = SubResource("AnimationNodeAnimation_gnmc2")
states/idle/position = Vector2(323, 100)
states/run/node = SubResource("AnimationNodeAnimation_jhdi8")
states/run/position = Vector2(438, 100)

[sub_resource type="BoxShape3D" id="BoxShape3D_i3822"]

[sub_resource type="SphereShape3D" id="SphereShape3D_g2vom"]
radius = 3.463

[sub_resource type="ViewportTexture" id="ViewportTexture_ijm7n"]
viewport_path = NodePath("SubViewport")

[sub_resource type="Curve" id="Curve_y7q5s"]
_data = [Vector2(0, 1), 0.0, -1.0, 0, 1, Vector2(1, 0), -1.0, 0.0, 1, 0]
point_count = 2

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_jhdi8"]
transparency = 1
blend_mode = 1
shading_mode = 0
albedo_color = Color(1, 1, 1, 0.38431373)

[sub_resource type="Curve" id="Curve_d8ups"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(1, 0), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_7uknu"]
curve = SubResource("Curve_d8ups")

[sub_resource type="Curve" id="Curve_veu6t"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(1, 0), -2.7659185, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_dlomd"]
curve = SubResource("Curve_veu6t")

[sub_resource type="Curve" id="Curve_lq60m"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(1, 0), -3.057878, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_nm8sw"]
curve = SubResource("Curve_lq60m")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_3kgx1"]
direction = Vector3(0, 0.5, 1)
initial_velocity_min = 6.0
initial_velocity_max = 10.0
scale_min = 0.79999995
scale_max = 1.3
scale_curve = SubResource("CurveTexture_nm8sw")
alpha_curve = SubResource("CurveTexture_7uknu")
emission_curve = SubResource("CurveTexture_dlomd")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_ud8xd"]
transparency = 1
shading_mode = 0
vertex_color_use_as_albedo = true
albedo_texture = ExtResource("17_nm8sw")
billboard_mode = 3
billboard_keep_scale = true
particles_anim_h_frames = 1
particles_anim_v_frames = 1
particles_anim_loop = false

[sub_resource type="QuadMesh" id="QuadMesh_3dy27"]
material = SubResource("StandardMaterial3D_ud8xd")

[sub_resource type="Curve" id="Curve_gmhxj"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(1, 0), -3.057878, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_lvi8h"]
curve = SubResource("Curve_gmhxj")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_qli8l"]
direction = Vector3(0, 1, 0)
spread = 85.0
initial_velocity_min = 6.0
initial_velocity_max = 10.0
scale_min = 0.79999995
scale_max = 1.3
scale_curve = SubResource("CurveTexture_lvi8h")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_nm8sw"]
transparency = 1
shading_mode = 0
albedo_color = Color(1, 0, 0, 0)

[node name="DynaMite" type="CharacterBody3D" unique_id=661467667 groups=["Enemies"]]
collision_layer = 10
collision_mask = 3
script = ExtResource("1_gnlae")
DETECTION_RANGE = 10.0
COUNTDOWN_RANGE = 3.0
DAMAGE = 7.0
attack_radius = 5.0
passive_death_time = 0.5

[node name="dynamite_anims" parent="." unique_id=131073368 instance=ExtResource("2_nm8sw")]
transform = Transform3D(-1, 0, -8.742278e-08, 0, 1, 0, 8.742278e-08, 0, -1, 0, 0, 0)

[node name="AnimationTree" type="AnimationTree" parent="dynamite_anims" unique_id=1292558925]
tree_root = SubResource("AnimationNodeStateMachine_d8ups")
anim_player = NodePath("../AnimationPlayer")

[node name="idle" type="Node" parent="dynamite_anims" unique_id=62196674]
script = ExtResource("3_ud8xd")
state_name = "idle"
animation_tree = Object(AnimationTree,"unique_name_in_owner":false,"process_mode":0,"process_priority":0,"process_physics_priority":0,"process_thread_group":0,"physics_interpolation_mode":0,"auto_translate_mode":0,"editor_description":"","active":true,"deterministic":true,"reset_on_save":true,"root_node":NodePath(".."),"root_motion_track":NodePath(""),"root_motion_local":false,"audio_max_polyphony":32,"callback_mode_process":1,"callback_mode_method":0,"callback_mode_discrete":2,"tree_root":SubResource("AnimationNodeStateMachine_d8ups"),"advance_expression_base_node":NodePath("."),"anim_player":NodePath("../AnimationPlayer"),"script":null)

metadata/_custom_type_script = "uid://bjlnudp8j65ma"

[node name="move" type="Node" parent="dynamite_anims" unique_id=1049299748]
script = ExtResource("3_ud8xd")
state_name = "run"
animation_tree = Object(AnimationTree,"unique_name_in_owner":false,"process_mode":0,"process_priority":0,"process_physics_priority":0,"process_thread_group":0,"physics_interpolation_mode":0,"auto_translate_mode":0,"editor_description":"","active":true,"deterministic":true,"reset_on_save":true,"root_node":NodePath(".."),"root_motion_track":NodePath(""),"root_motion_local":false,"audio_max_polyphony":32,"callback_mode_process":1,"callback_mode_method":0,"callback_mode_discrete":2,"tree_root":SubResource("AnimationNodeStateMachine_d8ups"),"advance_expression_base_node":NodePath("."),"anim_player":NodePath("../AnimationPlayer"),"script":null)

metadata/_custom_type_script = "uid://bjlnudp8j65ma"

[node name="attack" type="Node" parent="dynamite_anims" unique_id=2062818342]
script = ExtResource("3_ud8xd")
state_name = "attack"
animation_tree = Object(AnimationTree,"unique_name_in_owner":false,"process_mode":0,"process_priority":0,"process_physics_priority":0,"process_thread_group":0,"physics_interpolation_mode":0,"auto_translate_mode":0,"editor_description":"","active":true,"deterministic":true,"reset_on_save":true,"root_node":NodePath(".."),"root_motion_track":NodePath(""),"root_motion_local":false,"audio_max_polyphony":32,"callback_mode_process":1,"callback_mode_method":0,"callback_mode_discrete":2,"tree_root":SubResource("AnimationNodeStateMachine_d8ups"),"advance_expression_base_node":NodePath("."),"anim_player":NodePath("../AnimationPlayer"),"script":null)

metadata/_custom_type_script = "uid://bjlnudp8j65ma"

[node name="hurt" type="Node" parent="dynamite_anims" unique_id=268664347]
script = ExtResource("3_ud8xd")
state_name = "Hurt"
animation_tree = Object(AnimationTree,"unique_name_in_owner":false,"process_mode":0,"process_priority":0,"process_physics_priority":0,"process_thread_group":0,"physics_interpolation_mode":0,"auto_translate_mode":0,"editor_description":"","active":true,"deterministic":true,"reset_on_save":true,"root_node":NodePath(".."),"root_motion_track":NodePath(""),"root_motion_local":false,"audio_max_polyphony":32,"callback_mode_process":1,"callback_mode_method":0,"callback_mode_discrete":2,"tree_root":SubResource("AnimationNodeStateMachine_d8ups"),"advance_expression_base_node":NodePath("."),"anim_player":NodePath("../AnimationPlayer"),"script":null)

metadata/_custom_type_script = "uid://bjlnudp8j65ma"

[node name="Die" type="Node" parent="dynamite_anims" unique_id=1450630128]
script = ExtResource("3_ud8xd")
state_name = "hurt"
animation_tree = Object(AnimationTree,"unique_name_in_owner":false,"process_mode":0,"process_priority":0,"process_physics_priority":0,"process_thread_group":0,"physics_interpolation_mode":0,"auto_translate_mode":0,"editor_description":"","active":true,"deterministic":true,"reset_on_save":true,"root_node":NodePath(".."),"root_motion_track":NodePath(""),"root_motion_local":false,"audio_max_polyphony":32,"callback_mode_process":1,"callback_mode_method":0,"callback_mode_discrete":2,"tree_root":SubResource("AnimationNodeStateMachine_d8ups"),"advance_expression_base_node":NodePath("."),"anim_player":NodePath("../AnimationPlayer"),"script":null)

metadata/_custom_type_script = "uid://bjlnudp8j65ma"

[node name="Grass Change" type="Node" parent="dynamite_anims/Die" unique_id=1141750121]
script = ExtResource("4_lvi8h")
return_to_default = false
delay = 0.5
grass_displacement_size = 3.0
tween_transition = 1
timer = true
duration = 3.0

[node name="CollisionShape3D" type="CollisionShape3D" parent="." unique_id=943803878]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5, 0)
shape = SubResource("BoxShape3D_i3822")

[node name="StateMachine" type="Node" parent="." unique_id=720466032]
script = ExtResource("2_ybb5r")
metadata/_custom_type_script = "uid://dcfoaiv83pvo4"

[node name="idle" type="Node" parent="StateMachine" unique_id=1556334847]
script = ExtResource("3_5e5g7")

[node name="approach" type="Node" parent="StateMachine" unique_id=627465706]
script = ExtResource("4_ljwvm")

[node name="WalkSFX" type="FmodEventEmitter3D" parent="StateMachine/approach" unique_id=124348791]
event_name = "event:/Enemys/DynaMite/DynaMite Footstep"
event_guid = "{59220500-0a68-401d-b89b-6e58c0afbd68}"

[node name="countdown" type="Node" parent="StateMachine" unique_id=2041955926]
script = ExtResource("5_htoe2")

[node name="dead" type="Node" parent="StateMachine" unique_id=138650656]
script = ExtResource("6_g2vom")

[node name="DeathSFX" type="FmodEventEmitter3D" parent="StateMachine/dead" unique_id=1246138874]
event_name = "event:/Enemys/DynaMite/DynaMite Die"
event_guid = "{3a016713-c2d4-4c8c-839a-88bf01c26dfc}"

[node name="break" type="Node" parent="StateMachine" unique_id=143826169]
script = ExtResource("7_ybb5r")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="." unique_id=349219623]

[node name="CountdownTimer" type="Timer" parent="." unique_id=1050242143]
one_shot = true

[node name="Hitbox" type="Area3D" parent="." unique_id=1932725519]
visible = false
script = ExtResource("7_g2vom")
metadata/_custom_type_script = "uid://c1iptw5vqre6f"

[node name="CollisionShape3D" type="CollisionShape3D" parent="Hitbox" unique_id=381384261]
shape = SubResource("SphereShape3D_g2vom")

[node name="MeshInstance3D" type="MeshInstance3D" parent="." unique_id=44081661]

[node name="StatusBars" parent="." unique_id=1092069497 instance=ExtResource("10_bnow6")]
transform = Transform3D(0.70710677, -0.4055798, 0.579228, 0, 0.81915206, 0.57357645, -0.70710677, -0.4055798, 0.579228, 0, 1.5, 0)
texture = SubResource("ViewportTexture_ijm7n")

[node name="DynaMiteExplode" parent="." unique_id=1061697461 node_paths=PackedStringArray("pulse_mesh") instance=ExtResource("11_0gklw")]
explosion_color = Color(1, 0, 0, 1)
fuse_delay = 2.0
pulse_mesh = NodePath("../dynamite_anims/Skeleton3D/Dynamite")
pulse_count = 10
pulse_color = Color(1, 0.227451, 0, 1)
pulse_material_base = ExtResource("3_xrnix")
pulse_timing = SubResource("Curve_y7q5s")
play_on_start = false

[node name="FuseTimer" parent="DynaMiteExplode" index="0" unique_id=1217257398]
wait_time = 2.0

[node name="PulseTimer" parent="DynaMiteExplode" index="1" unique_id=964076599]
wait_time = 0.06153846557323763

[node name="MeshInstance3D" parent="DynaMiteExplode" index="2" unique_id=2026331758]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0)

[node name="HapticCaller" type="Node3D" parent="DynaMiteExplode" unique_id=1189232776]
script = ExtResource("14_dlomd")
small_motor = 0.2
large_motor = 0.6
metadata/_custom_type_script = "uid://c2h87hwcx212b"

[node name="DissolveFX" parent="." unique_id=1880495758 node_paths=PackedStringArray("meshes") instance=ExtResource("15_o6d2w")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5, 0)
meshes = [NodePath("../dynamite_anims/Skeleton3D/Dynamite")]

[node name="HitSFX" type="FmodEventEmitter3D" parent="." unique_id=873301741]
event_name = "event:/Enemys/DynaMite/DynaMite Hit"
event_guid = "{66e64576-83b8-4013-84c6-c5d913355836}"

[node name="Hurt" type="Node3D" parent="." unique_id=1761216653 node_paths=PackedStringArray("vfx", "meshes_root")]
script = ExtResource("15_7uknu")
vfx = NodePath("Hurt VFX")
meshes_root = NodePath("../dynamite_anims")
hurt_overlay = SubResource("StandardMaterial3D_jhdi8")
flash_duration = 0.5

[node name="Hurt VFX" type="Node3D" parent="Hurt" unique_id=20122196 node_paths=PackedStringArray("particles")]
script = ExtResource("16_dlomd")
particles = [NodePath("GPUParticles3D"), NodePath("GPUParticles3D")]
metadata/_custom_type_script = "uid://hrugoc51xhma"

[node name="GPUParticles3D" type="GPUParticles3D" parent="Hurt/Hurt VFX" unique_id=1959188255]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.39999998, 0.050730154)
emitting = false
lifetime = 0.5
one_shot = true
explosiveness = 1.0
process_material = SubResource("ParticleProcessMaterial_3kgx1")
draw_pass_1 = SubResource("QuadMesh_3dy27")

[node name="Death" type="Node3D" parent="." unique_id=54691021 node_paths=PackedStringArray("vfx", "meshes_root")]
script = ExtResource("18_ud8xd")
vfx = NodePath("Death VFX")
meshes_root = NodePath("../dynamite_anims")
flash_duration = 3.0
death_delay = 2.0
death_time = 2.0
fade_out = false

[node name="Death VFX" type="Node3D" parent="Death" unique_id=1358518131 node_paths=PackedStringArray("particles")]
script = ExtResource("16_dlomd")
particles = [NodePath("GPUParticles3D"), NodePath("GPUParticles3D")]
metadata/_custom_type_script = "uid://hrugoc51xhma"

[node name="GPUParticles3D" type="GPUParticles3D" parent="Death/Death VFX" unique_id=1799088318]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.099999905, 0.050730154)
emitting = false
amount = 17
lifetime = 0.5
one_shot = true
explosiveness = 1.0
process_material = SubResource("ParticleProcessMaterial_qli8l")
draw_pass_1 = SubResource("QuadMesh_3dy27")

[node name="Spawned" type="Node3D" parent="." unique_id=1186959072 node_paths=PackedStringArray("vfx", "meshes_root", "_meshes")]
process_mode = 3
script = ExtResource("19_lvi8h")
vfx = NodePath("enemySummonFX")
meshes_root = NodePath("../dynamite_anims")
_meshes = [NodePath("../dynamite_anims/Skeleton3D/Dynamite")]
hurt_overlay = SubResource("StandardMaterial3D_nm8sw")
flash_duration = 0.75

[node name="enemySummonFX" parent="Spawned" unique_id=352876712 instance=ExtResource("20_qq5db")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0)
lifetime = 1.25

[connection signal="break_update" from="." to="StatusBars" method="update_break"]
[connection signal="health_update" from="." to="StatusBars" method="update_health"]
[connection signal="hurt" from="." to="HitSFX" method="play_one_shot" unbinds=1]
[connection signal="entered" from="StateMachine/idle" to="dynamite_anims/idle" method="_on_idle_entered"]
[connection signal="entered" from="StateMachine/approach" to="StateMachine/approach/WalkSFX" method="play"]
[connection signal="entered" from="StateMachine/approach" to="dynamite_anims/move" method="enter"]
[connection signal="finished" from="StateMachine/approach" to="StateMachine/approach/WalkSFX" method="stop"]
[connection signal="entered" from="StateMachine/countdown" to="DynaMiteExplode" method="start_fuse"]
[connection signal="entered" from="StateMachine/countdown" to="dynamite_anims/attack" method="enter"]
[connection signal="entered" from="StateMachine/dead" to="StateMachine/dead/DeathSFX" method="play_one_shot"]
[connection signal="entered" from="StateMachine/dead" to="DissolveFX" method="beginDissolve"]
[connection signal="entered" from="StateMachine/dead" to="dynamite_anims/hurt" method="enter"]
[connection signal="timeout" from="CountdownTimer" to="StateMachine/countdown" method="_on_countdown_timer_timeout"]
[connection signal="exploded" from="DynaMiteExplode" to="DynaMiteExplode/HapticCaller" method="call_haptic"]

[editable path="dynamite_anims"]
[editable path="DynaMiteExplode"]
[editable path="Spawned/enemySummonFX"]
