[gd_scene load_steps=14 format=3 uid="uid://celvhgttbuade"]

[ext_resource type="Script" uid="uid://b3r7iadvf8jmk" path="res://scripts/entities/enemies/mossypede/Mossypede.gd" id="1_wqp5f"]
[ext_resource type="Script" uid="uid://dcfoaiv83pvo4" path="res://scripts/utility/states/state_machine.gd" id="2_kejld"]
[ext_resource type="PackedScene" uid="uid://pv4ghgiiejhk" path="res://scenes/dev/christian_d/enemy_status_bar.tscn" id="2_qufj0"]
[ext_resource type="PackedScene" uid="uid://bbhdok14mvale" path="res://art_assets/enemies/mossypede/mossypede.glb" id="2_sxa4w"]
[ext_resource type="Script" uid="uid://14v6se6ehp7y" path="res://scripts/entities/enemies/states/enemy_wait.gd" id="3_vv04i"]
[ext_resource type="Script" uid="uid://irxuylaptnty" path="res://scripts/entities/enemies/states/dead.gd" id="4_35qt8"]
[ext_resource type="Script" uid="uid://wjug80utd1ei" path="res://scripts/entities/enemies/mossypede/mossypede_attack.gd" id="4_vv04i"]

[sub_resource type="SphereShape3D" id="SphereShape3D_vv04i"]
radius = 0.25

[sub_resource type="BoxShape3D" id="BoxShape3D_l26uf"]
size = Vector3(1.435, 1, 1.72)

[sub_resource type="ViewportTexture" id="ViewportTexture_g0rg0"]
viewport_path = NodePath("SubViewport")

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_qufj0"]
animation = &"walk"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_yevcs"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_kejld"]
states/Start/position = Vector2(183, 115)
states/walk/node = SubResource("AnimationNodeAnimation_qufj0")
states/walk/position = Vector2(372, 110)
transitions = ["Start", "walk", SubResource("AnimationNodeStateMachineTransition_yevcs")]
graph_offset = Vector2(-166.28606, 47.961536)

[node name="Mossypede" type="CharacterBody3D"]
collision_layer = 10
collision_mask = 3
script = ExtResource("1_wqp5f")
attack_radius = 2.0
_base_speed = 10.0

[node name="StateMachine" type="Node" parent="." node_paths=PackedStringArray("initial_state")]
script = ExtResource("2_kejld")
initial_state = NodePath("Cooldown")
metadata/_custom_type_script = "uid://dcfoaiv83pvo4"

[node name="Cooldown" type="Node" parent="StateMachine" node_paths=PackedStringArray("post_wait_state", "player_far_state")]
script = ExtResource("3_vv04i")
wait_time = 2.0
post_wait_state = NodePath("../Attacking")
max_player_distance = 16.0
player_far_state = NodePath("../WaitForPlayer")

[node name="WaitForPlayer" type="Node" parent="StateMachine" node_paths=PackedStringArray("player_close_state")]
script = ExtResource("3_vv04i")
rotate_to_player = false
max_player_distance = 15.0
player_close_state = NodePath("../Cooldown")

[node name="Attacking" type="Node" parent="StateMachine" node_paths=PackedStringArray("reached_state")]
script = ExtResource("4_vv04i")
reached_state = NodePath("../Cooldown")

[node name="Dead" type="Node" parent="StateMachine"]
script = ExtResource("4_35qt8")

[node name="Cast" type="ShapeCast3D" parent="."]
shape = SubResource("SphereShape3D_vv04i")
target_position = Vector3(0, 0, -10)
collide_with_areas = true

[node name="mossypede" parent="." instance=ExtResource("2_sxa4w")]
transform = Transform3D(50, 0, 0, 0, 50, 0, 0, 0, 50, 0, -0.33761993, 0)

[node name="Skeleton3D" parent="mossypede" index="0"]
bones/2/rotation = Quaternion(-0.008669642, 0.70705366, -0.008669642, 0.7070536)
bones/3/position = Vector3(0.004338014, 0, 0)
bones/3/rotation = Quaternion(0.00079318875, 0.03693582, -0.021455176, 0.99908704)
bones/4/position = Vector3(0.0039445297, 0, 0)
bones/4/rotation = Quaternion(-0.0009263523, -0.065850645, -0.014035548, 0.99773043)
bones/5/position = Vector3(0.0039001813, 0, 0)
bones/5/rotation = Quaternion(0.0011431957, 0.027994584, -0.040786285, 0.998775)
bones/6/position = Vector3(0.0036199747, 0, 0)
bones/6/rotation = Quaternion(7.6150376e-05, -0.059651226, 0.0012743194, 0.99821854)
bones/9/position = Vector3(0.0046078106, 2.1878208e-05, 3.3017855e-05)
bones/9/rotation = Quaternion(-0.042047072, 0.065535724, -0.24845263, 0.9655095)
bones/10/position = Vector3(0.0032920872, 1.2404124e-05, 2.2668677e-05)
bones/10/rotation = Quaternion(-0.02207312, 0.1538831, 0.12488203, 0.97991705)
bones/12/position = Vector3(-0.003318063, -0.00018778043, 0)
bones/12/rotation = Quaternion(-0.0571006, 0.99822074, 0.0009806958, 0.017144317)
bones/13/position = Vector3(0.005339815, 0, 0)
bones/13/rotation = Quaternion(0.0028702437, 0.060903817, -0.046987653, 0.99703294)
bones/14/position = Vector3(0.0046522375, 0, 0)
bones/14/rotation = Quaternion(0.0048445608, -0.0969555, -0.049668886, 0.9940368)
bones/15/position = Vector3(0.0039887396, 0, 0)
bones/15/rotation = Quaternion(0.0021393935, 0.12582015, -0.016865987, 0.9919075)

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
shape = SubResource("BoxShape3D_l26uf")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
debug_path_custom_color = Color(0, 1, 0, 1)

[node name="StatusBars" parent="." instance=ExtResource("2_qufj0")]
transform = Transform3D(0.70710677, -0.4055798, 0.579228, 0, 0.81915206, 0.57357645, -0.70710677, -0.4055798, 0.579228, 0, 2.035, 0)
texture = SubResource("ViewportTexture_g0rg0")

[node name="AnimationTree" type="AnimationTree" parent="."]
root_node = NodePath("../mossypede")
tree_root = SubResource("AnimationNodeStateMachine_kejld")
anim_player = NodePath("../mossypede/AnimationPlayer")

[connection signal="break_update" from="." to="StatusBars" method="update_break"]
[connection signal="health_update" from="." to="StatusBars" method="update_health"]

[editable path="mossypede"]
